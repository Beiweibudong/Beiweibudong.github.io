(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{195:function(t,s,a){"use strict";a.r(s);var n=a(0),o=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("前言")]),t._v(" "),a("p",[t._v("最近发现某网又能访问了，这时好时坏的网络让人很没安全感，于是就打算写个爬虫将上边的小说全都下载下来，以防不测。本次使用的模块是bs4和requests。")])]),t._v(" "),a("h2",{attrs:{id:"一、检查页面元素特征，确定爬取点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、检查页面元素特征，确定爬取点","aria-hidden":"true"}},[t._v("#")]),t._v(" 一、检查页面元素特征，确定爬取点")]),t._v(" "),a("p",[t._v("检查了下这次所要提取的页面，标记的比较完整。列表链接都被框在了一个class里，下一页也用唯一的标记给定了。点击列表链接查看文本内容，标题是一个class，文本是一个class（文本中也含有标题）。因此确定的方案是：")]),t._v(" "),a("ol",[a("li",[t._v("提取所有列表链接，2000多。")]),t._v(" "),a("li",[t._v("依次访问列表链接爬取内容写入到txt文本。")])]),t._v(" "),a("h2",{attrs:{id:"二、获取链接列表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、获取链接列表","aria-hidden":"true"}},[t._v("#")]),t._v(" 二、获取链接列表")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("requestLinks")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("URL"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" header"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    addr "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    nextLink"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" links "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" getNext"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("URL"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" header"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token comment"}},[t._v("#将当前页列表链接整理成可访问形式，继续处理下一页")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("while")]),t._v(" nextLink "),a("span",{attrs:{class:"token keyword"}},[t._v("is")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("not")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("None")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        url "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" URLS "),a("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" nextLink"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'href'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" link "),a("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" links"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            urlink "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" URLS "),a("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" link"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'href'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            addr"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("append"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("urlink"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        nextLink"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" links "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" getNext"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" header"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("print")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'finished reading catalog......'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("print")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'starting reading content......'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    readAndWrite"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("addr"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("#获取当前页的所有列表链接，同时获得下一页的链接")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("getNext")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("URL"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" header"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    res "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("URL"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("header"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" verify"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token boolean"}},[t._v("False")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    res"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encoding "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'utf-8'")]),t._v("\n    html "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" res"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text\n    soup "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" BeautifulSoup"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("html"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'html.parser'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    links "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" soup"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("class_"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token string"}},[t._v("'box-topic-list p-0 clearfix'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    links "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" links"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_all"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'a'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    nextLink "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" soup"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("class_"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token string"}},[t._v("'next pagegbk'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nextLink"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" links\n")])])]),a("h2",{attrs:{id:"三、读取页面内容并写入文本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、读取页面内容并写入文本","aria-hidden":"true"}},[t._v("#")]),t._v(" 三、读取页面内容并写入文本")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("readAndWrite")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("addr"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    DIRT "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'F:\\\\readNovel\\\\Novel\\\\'")]),t._v("\n    count "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" link "),a("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" addr"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        res "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("link"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("header"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" verify"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token boolean"}},[t._v("False")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        res"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encoding "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'utf-8'")]),a("span",{attrs:{class:"token comment"}},[t._v("#会自动识别页面编码，但这次误识别了，影响之后bs解码，需指定")]),t._v("\n        html "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" res"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text\n        soup "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" BeautifulSoup"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("html"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token string"}},[t._v("'html.parser'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        title "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" soup"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("class_"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token string"}},[t._v("'text-overflow'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        title "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" title"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("string\n        text "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" soup"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("class_"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token string"}},[t._v("'layout-box clearfix'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        text "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" text"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_text"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"\\n"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        dirr "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" DIRT "),a("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{attrs:{class:"token builtin"}},[t._v("str")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("count"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'.txt'")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("print")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'writing the %d content...'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("%")]),t._v(" count"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),a("span",{attrs:{class:"token builtin"}},[t._v("open")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dirr"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'w'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("as")]),t._v(" f"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{attrs:{class:"token keyword"}},[t._v("try")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                f"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("write"),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{attrs:{class:"token keyword"}},[t._v("except")]),t._v(" Exception "),a("span",{attrs:{class:"token keyword"}},[t._v("as")]),t._v(" e"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),a("span",{attrs:{class:"token keyword"}},[t._v("print")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'exixts error...'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{attrs:{class:"token keyword"}},[t._v("continue")]),t._v("\n        count "),a("span",{attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("print")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'Write a total of %d txt.....'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("%")]),t._v(" count"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])}],!1,null,null,null);o.options.__file="爬取某网小说以便离线观看.md";s.default=o.exports}}]);